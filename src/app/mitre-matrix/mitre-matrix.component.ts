import { Component, OnDestroy, OnInit, Input, OnChanges, SimpleChanges } from '@angular/core';
import { Subscription } from 'rxjs';

@Component({
  selector: 'app-mitre-matrix',
  templateUrl: './mitre-matrix.component.html',
  styleUrls: ['./mitre-matrix.component.css']
})
export class MitreMatrixComponent implements OnInit, OnChanges {
  @Input() toolsSelected = [];

  ngOnInit() { }

  ngOnChanges(changes: SimpleChanges) {
    this.highlight();
  }

  highlight() {
    var tds = document.getElementsByTagName("td");
    for (var i = 0; i < tds.length; i++) {
      tds[i].classList.remove("highlight");
    }

    if (this.toolsSelected.includes('nmap_default')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine domain and IP address space-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine firmware version-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate client configurations-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate externally facing software applications technologies, languages, and dependencies-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify security defensive capabilities-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-organizational information gathering-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('nmap_vuln')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine firmware version-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate client configurations-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate externally facing software applications technologies, languages, and dependencies-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-organizational information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('theharvester')) {
      document.getElementById("v-Acquire OSINT data sets and information-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Conduct social engineering-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine domain and IP address space-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine external network trust dependencies-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Discover target logon/email address format-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify job postings and needs/gaps-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Spearphishing for Information-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Acquire OSINT data sets and information-people information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify groups/roles-people information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify people of interest-people information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify personnel with an authority/privilege-people information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify sensitive personnel information-people information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Mine social media-people information gathering-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('sublist3r')) {
      document.getElementById("v-Acquire OSINT data sets and information-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine domain and IP address space-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate client configurations-technical information gathering-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('gobuster')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('whatweb')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine firmware version-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate client configurations-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate externally facing software applications technologies, languages, and dependencies-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify security defensive capabilities-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-organizational information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('wpscan_default')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine firmware version-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate client configurations-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate externally facing software applications technologies, languages, and dependencies-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify security defensive capabilities-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-organizational information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('joomscan_default')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine firmware version-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate client configurations-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Enumerate externally facing software applications technologies, languages, and dependencies-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify security defensive capabilities-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Determine 3rd party infrastructure services-organizational information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('wpscan_bruteforce')) {
      document.getElementById("v-Discover target logon/email address format-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('nmap_joomla')) {
      document.getElementById("v-Discover target logon/email address format-technical information gathering-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('nmap_heartbleed')) {
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('nmap_poodle')) {
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('nmap_drown')) {
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('wapiti_sqli')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
    if (this.toolsSelected.includes('wapiti_xss')) {
      document.getElementById("v-Conduct active scanning-technical information gathering-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze application security posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze architecture and configuration posture-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Analyze hardware/software security defensive capabilities-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Identify vulnerabilities in third-party software libraries-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Research relevant vulnerabilities/CVEs-technical weakness identification-tab").parentElement.className += " highlight";
      document.getElementById("v-Proxy/protocol relays-adversary opsec-tab").parentElement.className += " highlight";
    }
  }
}
