<div *ngIf="!newScanBool">
    <h2 *ngIf="mode=='auto'">Custom scan, select the tools you want for the scan</h2>
    <h2 *ngIf="mode=='nmap'">Port scan (information about the ports of the machine)</h2>
    <h2 *ngIf="mode=='whois'">OSINT scan (information about the host from the web)</h2>
    <h2 *ngIf="mode=='whatweb'">Website scan (information about techonologies used by the website)</h2>
    <h2 *ngIf="mode=='wapiti'">Exploits scan (searching for common vulnerabilities like xss, sqli and others)</h2>
    <h2 *ngIf="mode=='sqli'">SQLi scan (searches for sqli vulnerabilities)</h2>
    <h2 *ngIf="mode=='xss'">XSS scan (searches for xss vulnerabilities)</h2>
    <h2 *ngIf="mode=='wpscan'">Wordpress website scan (information and vulnerabilities considering used theme, plugins, etc.)</h2>
    <h2 *ngIf="mode=='joomscan'">Joomla website scan (information and vulnerabilities considering used theme, plugins, etc.)</h2>
    <h2 *ngIf="mode=='sublist3r'">Subdomains scan (searches for given domain subdomains)</h2>
    <h2 *ngIf="mode=='gobuster'">Bruteforce URIs (directory and files in websites)</h2>
</div>

<form class="needs-validation" novalidate (submit)="onNewScan(scanForm)" #scanForm="ngForm" *ngIf="!newScanBool">
    <div class="form-row">
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="https://www.example.com" aria-label="IP to scan" aria-describedby="basic-addon2" name="enteredIp" ngModel #enteredIp="ngModel" required>
            <div *ngIf="enteredIp.invalid" class="invalid-feedback">
                Please enter an Ip.
            </div>
            <div class="input-group-append">
                <button class="btn btn-orange" type="submit"> <span *ngIf="!scanning"> Scan </span> <span *ngIf="scanning"> Scanning... </span> </button>
            </div>
        </div>

        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <input style="margin-right: 5px;" type="checkbox" data-md-icheck (change)="toggleProxy($event)" />
            <label for="proxy" style="margin-bottom: initial; margin-right: 5px;">Proxy: </label>
            <input type="text" [disabled]="!proxyEnabled" class="form-control" placeholder="http://127.0.0.1" aria-label="proxy" aria-describedby="basic-addon2" name="proxy" ngModel #proxy="ngModel">
        </div>

        <!-- Auto -->
        <div *ngIf="mode == 'auto'" style="display: flex; width: 100%; justify-content: space-between;">
            <div>
                <h4>Information Gathering</h4>
                <div *ngFor="let tool of scan.infoGathTools; let i=index" class="form-check">

                    <input class="form-check-input" type="checkbox" name={{scan.infoGathTools[i].id}} ngModel #tools="ngModel" /> {{scan.infoGathTools[i].name}}
                </div>
            </div>
            <div>
                <h4>Web Application testing</h4>
                <div *ngFor="let tool of scan.webAppTools; let i=index" class="form-check">

                    <input class="form-check-input" type="checkbox" name={{scan.webAppTools[i].id}} ngModel #tools="ngModel" /> {{scan.webAppTools[i].name}}
                </div>
            </div>
            <div>
                <h4>CMS Testing</h4>
                <div *ngFor="let tool of scan.cmsTools; let i=index" class="form-check">

                    <input class="form-check-input" type="checkbox" name={{scan.cmsTools[i].id}} ngModel #tools="ngModel" /> {{scan.cmsTools[i].name}}
                </div>
            </div>
            <div>
                <h4>Infrastructure</h4>
                <div *ngFor="let tool of scan.infrastructureTools; let i=index" class="form-check">

                    <input class="form-check-input" type="checkbox" name={{scan.infrastructureTools[i].id}} ngModel #tools="ngModel" /> {{scan.infrastructureTools[i].name}}
                </div>
            </div>
            <div>
                <h4>Exploits</h4>
                <div *ngFor="let tool of scan.exploitTools; let i=index" class="form-check">

                    <input class="form-check-input" type="checkbox" name={{scan.exploitTools[i].id}} ngModel #tools="ngModel" /> {{scan.exploitTools[i].name}}
                </div>
            </div>


            <!-- <div *ngFor="let tool of scan.tools; let i=index" class="form-check">

                <input class="form-check-input" type="checkbox" name={{scan.tools[i].id}} ngModel #tools="ngModel" /> {{scan.tools[i].name}}
            </div> -->
        </div>
    </div>
</form>

<ngx-spinner type="ball-clip-rotate">
    <p style="font-size: 20px; color: white"> This might take a while... </p>
</ngx-spinner>

<!--Scroll to top-->
<div class="scroll-to-top" [ngClass]="{'show-scrollTop': windowScrolled}">
    <button class="btn btn-outline-secondary" (click)="scrollToTop()">
        <img src="../../../assets/arrow-up.png" />
    </button>
</div>

<button class="btn btn-orange new-scan-btn" (click)="newScanBtnClickListener()" *ngIf="newScanBool">New Scan</button>

<div *ngIf="newScanBool">
    <app-joomla-output [outputObj]="outputObj" *ngIf="mode == 'joomscan'"></app-joomla-output>
    <app-wp-output [outputObj]="outputObj" *ngIf="mode == 'wpscan'"></app-wp-output>
    <app-nmap-output [outputObj]="outputObj" *ngIf="mode == 'nmap'"></app-nmap-output>
    <app-sublist3r-output [outputObj]="outputObj" *ngIf="mode == 'sublist3r'"></app-sublist3r-output>
    <app-gobuster-output [outputObj]="outputObj" *ngIf="mode == 'gobuster'"></app-gobuster-output>
    <app-whois-output [outputObj]="outputObj" *ngIf="mode == 'whois'"></app-whois-output>
    <app-whatweb-output [outputObj]="outputObj" *ngIf="mode == 'whatweb'"></app-whatweb-output>
    <app-wapiti-output [outputObj]="outputObj" *ngIf="mode == 'wapiti' || mode == 'sqli' || mode == 'xss'"></app-wapiti-output>

    <div *ngIf="mode == 'auto'">
        <div *ngIf="autoScanTools.includes('nmap_default') || autoScanTools.includes('nmap_vuln')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedNmap" type="button" class="btn" (click)="isCollapsedNmap = !isCollapsedNmap" [attr.aria-expanded]="!isCollapsedNmap" aria-controls="collapseNmap"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedNmap" type="button" class="btn" (click)="isCollapsedNmap = !isCollapsedNmap" [attr.aria-expanded]="!isCollapsedNmap" aria-controls="collapseNmap"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('nmap_default') && !autoScanTools.includes('nmap_vuln')" class="output-title">Port scan output</h4>
                <h4 *ngIf="autoScanTools.includes('nmap_vuln') && !autoScanTools.includes('nmap_default')" class="output-title">Port vulnerability scan output</h4>
                <h4 *ngIf="autoScanTools.includes('nmap_vuln') && autoScanTools.includes('nmap_default')" class="output-title">Port scan && Port vulnerability scan output</h4>
            </div>
            <div id="isCollapsedNmap" [collapse]="!isCollapsedNmap" [isAnimated]="true">
                <app-nmap-output [outputObj]="outputObj"></app-nmap-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('gobuster')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedGobuster" type="button" class="btn" (click)="isCollapsedGobuster = !isCollapsedGobuster" [attr.aria-expanded]="!isCollapsedGobuster" aria-controls="collapseGobuster"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedGobuster" type="button" class="btn" (click)="isCollapsedGobuster = !isCollapsedGobuster" [attr.aria-expanded]="!isCollapsedGobuster" aria-controls="collapseGobuster"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('gobuster')" class="output-title">Bruteforce URIs outputs</h4>
            </div>
            <div id="isCollapsedGobuster" [collapse]="!isCollapsedGobuster" [isAnimated]="true">
                <app-gobuster-output [outputObj]="outputObj"></app-gobuster-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('sublist3r')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedSublist3r" type="button" class="btn" (click)="isCollapsedSublist3r = !isCollapsedSublist3r" [attr.aria-expanded]="!isCollapsedSublist3r" aria-controls="collapseSublist3r"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedSublist3r" type="button" class="btn" (click)="isCollapsedSublist3r = !isCollapsedSublist3r" [attr.aria-expanded]="!isCollapsedSublist3r" aria-controls="collapseSublist3r"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('sublist3r')" class="output-title">Subdomain scan outputs</h4>
            </div>
            <div id="isCollapsedSublist3r" [collapse]="!isCollapsedSublist3r" [isAnimated]="true">
                <app-sublist3r-output [outputObj]="outputObj"></app-sublist3r-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('wpscan_default') || autoScanTools.includes('wpscan_bruteforce')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedWpscan" type="button" class="btn" (click)="isCollapsedWpscan = !isCollapsedWpscan" [attr.aria-expanded]="!isCollapsedWpscan" aria-controls="collapseWpscan"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedWpscan" type="button" class="btn" (click)="isCollapsedWpscan = !isCollapsedWpscan" [attr.aria-expanded]="!isCollapsedWpscan" aria-controls="collapseWpscan"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('wpscan_default') && !autoScanTools.includes('wpscan_bruteforce')" class="output-title">Wordpress scanner output</h4>
                <h4 *ngIf="!autoScanTools.includes('wpscan_default') && autoScanTools.includes('wpscan_bruteforce')" class="output-title">Wordpress authentication bruteforce output</h4>
                <h4 *ngIf="autoScanTools.includes('wpscan_default') && autoScanTools.includes('wpscan_bruteforce')" class="output-title">Wordpress scanner and authentication bruteforce output</h4>
            </div>
            <div id="isCollapsedWpscan" [collapse]="!isCollapsedWpscan" [isAnimated]="true">
                <app-wp-output [outputObj]="outputObj"></app-wp-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('joomscan_default') || autoScanTools.includes('nmap_joomla')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedJoomscan" type="button" class="btn" (click)="isCollapsedJoomscan = !isCollapsedJoomscan" [attr.aria-expanded]="!isCollapsedJoomscan" aria-controls="collapseJoomscan"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedJoomscan" type="button" class="btn" (click)="isCollapsedJoomscan = !isCollapsedJoomscan" [attr.aria-expanded]="!isCollapsedJoomscan" aria-controls="collapseJoomscan"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('joomscan_default') && !autoScanTools.includes('nmap_joomla')" class="output-title">Joomla scanner output</h4>
                <h4 *ngIf="!autoScanTools.includes('joomscan_default') && autoScanTools.includes('nmap_joomla')" class="output-title">Joomla authentication bruteforce output</h4>
                <h4 *ngIf="autoScanTools.includes('joomscan_default') && autoScanTools.includes('nmap_joomla')" class="output-title">Joomla scanner and authentication bruteforce output</h4>
            </div>
            <div id="isCollapsedJoomscan" [collapse]="!isCollapsedJoomscan" [isAnimated]="true">
                <app-joomla-output [outputObj]="outputObj"></app-joomla-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('theharvester')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedTheHarvester" type="button" class="btn" (click)="isCollapsedTheHarvester = !isCollapsedTheHarvester" [attr.aria-expanded]="!isCollapsedTheHarvester" aria-controls="collapseTheHarvester"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedTheHarvester" type="button" class="btn" (click)="isCollapsedTheHarvester = !isCollapsedTheHarvester" [attr.aria-expanded]="!isCollapsedTheHarvester" aria-controls="collapseTheHarvester"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('theharvester')" class="output-title">OSINT gathering output</h4>
            </div>
            <div id="isCollapsedTheHarvester" [collapse]="!isCollapsedTheHarvester" [isAnimated]="true">
                <app-whois-output [outputObj]="outputObj"></app-whois-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('whatweb')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedWhatweb" type="button" class="btn" (click)="isCollapsedWhatweb = !isCollapsedWhatweb" [attr.aria-expanded]="!isCollapsedWhatweb" aria-controls="collapseWhatweb"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedWhatweb" type="button" class="btn" (click)="isCollapsedWhatweb = !isCollapsedWhatweb" [attr.aria-expanded]="!isCollapsedWhatweb" aria-controls="collapseWhatweb"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('whatweb')" class="output-title">Website scanner output</h4>
            </div>
            <div id="isCollapsedWhatweb" [collapse]="!isCollapsedWhatweb" [isAnimated]="true">
                <app-whatweb-output [outputObj]="outputObj"></app-whatweb-output>
            </div>
        </div>
        <div *ngIf="autoScanTools.includes('wapiti_sqli') || autoScanTools.includes('wapiti_xss')" style="margin-top: 20px;">
            <div class="output-wrapper">
                <button *ngIf="isCollapsedWapiti" type="button" class="btn" (click)="isCollapsedWapiti = !isCollapsedWapiti" [attr.aria-expanded]="!isCollapsedWapiti" aria-controls="collapseWapiti"><img src="../../../assets/arrow-up.png" /></button>
                <button *ngIf="!isCollapsedWapiti" type="button" class="btn" (click)="isCollapsedWapiti = !isCollapsedWapiti" [attr.aria-expanded]="!isCollapsedWapiti" aria-controls="collapseWapiti"><img src="../../../assets/arrow-down.png" /></button>
                <h4 *ngIf="autoScanTools.includes('wapiti_sqli') && !autoScanTools.includes('wapiti_xss')" class="output-title">SQLi scanner output</h4>
                <h4 *ngIf="!autoScanTools.includes('wapiti_sqli') && autoScanTools.includes('wapiti_xss')" class="output-title">XSS scanner output</h4>
                <h4 *ngIf="autoScanTools.includes('wapiti_sqli') && autoScanTools.includes('wapiti_xss')" class="output-title">SQLi and XSS scanner output</h4>
            </div>
            <div id="isCollapsedWapiti" [collapse]="!isCollapsedWapiti" [isAnimated]="true">
                <app-wapiti-output [outputObj]="outputObj"></app-wapiti-output>
            </div>
        </div>
    </div>
</div>
<!-- <p> {{ output }} </p> -->